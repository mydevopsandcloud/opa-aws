resource "aws_networkfirewall_rule_group" "stateless_example" {
  capacity = 100
  name     = "example-stateless"
  type     = "STATELESS"

  rule_group {
    rules_source {
      stateless_rules_and_custom_actions {
        stateless_rules {
          priority = 1
          rule_definition {
            actions = ["aws:pass"]
            match_attributes {
              protocols = [6]
              destination_ports {
                from_port = 80
                to_port   = 80
              }
            }
          }
        }
      }
    }
  }
}

resource "aws_networkfirewall_firewall_policy" "pass_policy" {
  name = "pass-policy"

  firewall_policy {
    stateless_rule_group_reference {
      priority       = 1
      rule_group_arn = aws_networkfirewall_rule_group.stateless_example.arn
    }
    stateless_default_actions            = ["aws:forward_to_sfe"]
    stateless_fragment_default_actions   = ["aws:forward_to_sfe"]
  }
}
